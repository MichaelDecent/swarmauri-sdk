sequenceDiagram
    participant User
    participant Gateway
    participant Worker
    User->>User: sign + encrypt for Gateway & Worker
    User->>Gateway: ciphertext
    Gateway->>Worker: forward ciphertext
    Worker->>Worker: decrypt with worker_priv
    Worker->>Worker: verify signature with user_pub
    Note over User: user_priv stays local
    Note over Gateway: only ciphertext stored
    Note over Worker: worker_priv stays on worker
