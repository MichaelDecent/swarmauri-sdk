sequenceDiagram
    participant User
    participant CLI as peagen remote program fetch
    participant Net as Workspace Source
    participant Pip as PackageInstaller
    participant Adapter as StorageAdapter
    User ->> CLI: Run `peagen remote program fetch workspace.json [--out dir]`
    CLI ->> FS: Create/prepare output directory (temp if not provided)
    loop For each descriptor in inputs
        CLI ->> Net: _download_descriptor(descriptor URI or path)
        Net -->> CLI: Returns descriptor data (JSON)
        alt if install_template_sets flag is true
            CLI ->> Pip: Install each template-set listed in descriptor (via pip)
        end
        alt if not no_source
            loop for each spec in descriptor["source_packages"]
                CLI ->> Adapter: _materialise_source_pkg(spec, out_dir) (clone or copy source)
            end
        end
        CLI ->> Adapter: _materialise_workspace(descriptor, out_dir) (download all generated files)
    end
    CLI -->> User: Output "workspace: [out_dir]" path of reconstructed workspace
